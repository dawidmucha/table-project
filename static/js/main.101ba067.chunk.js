(this["webpackJsonptable-project"]=this["webpackJsonptable-project"]||[]).push([[0],{14:function(e,t,n){e.exports=n(21)},20:function(e,t,n){},21:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(7),i=n.n(o),c=n(3),u=n(4),l=n.n(u),s=n(2),m=n(11),h=n(5),p=n(8),g=n(9),d=n(13),f=n(10),b=n(1),v=n(12),C=(n(20),function(e){function t(){var e;return Object(p.a)(this,t),(e=Object(d.a)(this,Object(f.a)(t).call(this))).state={companies:[],table:[],sorting:{id:void 0,name:void 0,city:void 0,sum:void 0,avg:void 0,last:void 0},inputs:{id:"",name:"",city:"",sum:"",avg:"",last:""},pagination:{recordsPerPage:10,pageNumber:0}},e.putTableContentToState=e.putTableContentToState.bind(Object(b.a)(e)),e.sortBy=e.sortBy.bind(Object(b.a)(e)),e.handleChange=e.handleChange.bind(Object(b.a)(e)),e.onSelectChange=e.onSelectChange.bind(Object(b.a)(e)),e}return Object(v.a)(t,e),Object(g.a)(t,[{key:"componentDidMount",value:function(){var e=this;fetch("https://recruitment.hal.skygate.io/companies").then((function(e,t){return e.json()})).then(function(){var t=Object(h.a)(l.a.mark((function t(n){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",Promise.all(n.map((function(t){return fetch("https://recruitment.hal.skygate.io/incomes/".concat(t.id)).then((function(e,t){return e.json()})).then((function(t){var a=n.filter((function(e){return e.id===t.id}))[0];e.setState((function(e){return{companies:[].concat(Object(m.a)(e.companies),[Object(s.a)({},a,{},t)])}}))}))}))));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).then((function(){e.putTableContentToState()})).catch((function(e){return console.log(e)}))}},{key:"putTableContentToState",value:function(){var e=Object(h.a)(l.a.mark((function e(){var t=this;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Promise.all(this.state.companies.map((function(e,n){t.setState((function(n){return{table:n.table.concat({id:e.id,name:e.name,city:e.city,sum:t.sumOfIncomes(e.incomes),avg:(t.sumOfIncomes(e.incomes)/e.incomes.length).toFixed(2),last:t.lastMonthIncome(e.incomes).toFixed(2)})}}))})));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleChange",value:function(e){var t=e.target;this.setState((function(e){return{inputs:Object(s.a)({},e.inputs,Object(c.a)({},t.name,t.value)),pagination:Object(s.a)({},e.pagination,{pageNumber:0})}}))}},{key:"sortBy",value:function(e){var t=this;this.setState((function(n){return"asc"===t.state.sorting[e]?{table:n.table.sort((function(t,n){return t[e]<n[e]?1:-1})),sorting:Object(c.a)({},e,"desc")}:{table:n.table.sort((function(t,n){return t[e]>n[e]?1:-1})),sorting:Object(c.a)({},e,"asc")}}))}},{key:"onPageChange",value:function(e,t,n){var a=this.state.pagination.recordsPerPage,r=this.state.pagination.pageNumber;e.preventDefault(),"gt"===t&&a*(r+1)<n?this.setState((function(e){return{pagination:Object(s.a)({},e.pagination,{pageNumber:e.pagination.pageNumber+1})}})):"lt"===t&&r>0&&this.setState((function(e){return{pagination:Object(s.a)({},e.pagination,{pageNumber:e.pagination.pageNumber-1})}}))}},{key:"onSelectChange",value:function(e){var t=e.target;this.setState((function(e){return{pagination:Object(s.a)({},e.pagination,{recordsPerPage:t.value,pageNumber:0})}}))}},{key:"sumOfIncomes",value:function(e){var t=e.reduce((function(e,t){return e+parseFloat(t.value)}),0);return(Math.round(100*t)/100).toFixed(2)}},{key:"lastMonthIncome",value:function(e){var t=new Date(Date.now()),n=t.getMonth()<=9?"0".concat(t.getMonth()):t.getMonth(),a="^".concat(t.getFullYear(),"-").concat(n-1);return e.reduce((function(e,t){return t.date.match(a)?e+parseFloat(t.value):e}),0)}},{key:"render",value:function(){var e=this,t=this.state.pagination.recordsPerPage,n=this.state.pagination.pageNumber,a=this.state.table.filter((function(t){return t.id.toString().includes(e.state.inputs.id)&&t.name.toLowerCase().includes(e.state.inputs.name.toLowerCase())&&t.city.toLowerCase().includes(e.state.inputs.city.toLowerCase())&&t.sum.toLowerCase().includes(e.state.inputs.sum.toLowerCase())&&t.avg.toLowerCase().includes(e.state.inputs.avg.toLowerCase())&&t.last.toLowerCase().includes(e.state.inputs.last.toLowerCase())})).map((function(e,a){if(a>=t*n&&a<=t*(n+1)-1)return r.a.createElement("tr",null,r.a.createElement("td",null,e.id),r.a.createElement("td",null,e.name),r.a.createElement("td",null,e.city),r.a.createElement("td",null,(new Intl.NumberFormat).format(e.sum)),r.a.createElement("td",null,(new Intl.NumberFormat).format(e.avg)),r.a.createElement("td",null,(new Intl.NumberFormat).format(e.last)))}));return r.a.createElement("div",null,r.a.createElement("table",null,r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{onClick:function(){return e.sortBy("id")}},"id"),r.a.createElement("th",{onClick:function(){return e.sortBy("name")}},"name"),r.a.createElement("th",{onClick:function(){return e.sortBy("city")}},"city"),r.a.createElement("th",{onClick:function(){return e.sortBy("sum")}},"tot. income"),r.a.createElement("th",{onClick:function(){return e.sortBy("avg")}},"avg. income"),r.a.createElement("th",{onClick:function(){return e.sortBy("last")}},"last month income"))),r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("td",null,r.a.createElement("input",{id:"tSearchId",type:"text",name:"id",onChange:this.handleChange})),r.a.createElement("td",null,r.a.createElement("input",{id:"tSearchName",type:"text",name:"name",onChange:this.handleChange})),r.a.createElement("td",null,r.a.createElement("input",{id:"tSearchCity",type:"text",name:"city",onChange:this.handleChange})),r.a.createElement("td",null,r.a.createElement("input",{id:"tSearchSum",type:"text",name:"sum",onChange:this.handleChange})),r.a.createElement("td",null,r.a.createElement("input",{id:"tSearchAvg",type:"text",name:"avg",onChange:this.handleChange})),r.a.createElement("td",null,r.a.createElement("input",{id:"tSearchLast",type:"text",name:"last",onChange:this.handleChange}))),a,r.a.createElement("tr",null,r.a.createElement("td",{colspan:"6"},r.a.createElement("form",null,r.a.createElement("button",{id:"backButton",onClick:function(t){return e.onPageChange(t,"lt",a.length)}},"<"),r.a.createElement("select",{id:"dropdown",name:"recordsPerPage",onChange:this.onSelectChange,value:this.state.pagination.recordsPerPage},r.a.createElement("option",{value:"10"},"10"),r.a.createElement("option",{value:"25"},"25"),r.a.createElement("option",{value:"50"},"50"),r.a.createElement("option",{value:"100"},"100")),r.a.createElement("button",{id:"forwardButton",onClick:function(t){return e.onPageChange(t,"gt",a.length)}},">")),r.a.createElement("span",null,"(".concat(n*t+1,"-").concat((n+1)*t<a.length?(n+1)*t:a.length,")/").concat(a.length)))))))}}]),t}(r.a.Component));i.a.render(r.a.createElement(C,null),document.getElementById("root"))}},[[14,1,2]]]);
//# sourceMappingURL=main.101ba067.chunk.js.map